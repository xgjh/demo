{% extends 'layout.html' %}
{% block content %}
<section class="content">
    <div class="box box-warning">
        <div class="box-header with-border">
            <h3 class="box-title">文章发布</h3>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
            <!--<form role="form">-->
                <!-- text input -->
                <div class="form-group">
                    <label>标题</label>
                    <input type="text" class="form-control" value="Facebook">
                </div>
                <div class="form-group">
                    <label>作者</label>
                    <input type="text" class="form-control" value="张三" >
                </div>
                <div class="form-group">
                    <label>简介</label>
                    <input type="text" class="form-control" value="将在更多产品上推出故事功能" >
                </div>
                <div class="form-group">
                    <label>时间</label>
                    <div class="input-group date" data-provide="datepicker">
                        <input type="text" class="form-control">
                        <div class="input-group-addon">
                            <span class="glyphicon glyphicon-th"></span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>上传图片</label>
                    <form action="/upload" method="post" class="dropzone" id="my-upload" style="border: 2px dashed #00acd6;">
                        <div class="fallback">
                            <input name="file" type="file" multiple />
                        </div>
                    </form>
                </div>
                <img src="" id="test-img" alt="">

                <!-- textarea -->
                <div class="form-group">
                    <label>文章正文</label>
                    <textarea class="form-control" rows="3" placeholder="Enter ...">据报道，Facebook 创始人马克 · 扎克伯格在公司财报电话会议上阐述了脸书的未来愿景，称故
事、消息和视频将推动公司未来的增长 ... 虽然 Instagram 等应用的推出大获成功，但故事功能
在脸书主应用上却遇冷。但扎克伯格表示，Facebook 将在更多产品上推出故事功能，故事蕴藏
的商机将「大于」消息流 ... Facebook 首席运营官谢</textarea>
                </div>
                <div class="btn btn-primary">
                    发布文章</div>
            <!--</form>-->
        </div>
        <!-- /.box-body -->
    </div>

</section>
<script>
    Dropzone.autoDiscover = false;
    window.onload=function(){
        $('.datepicker').datepicker();
        var myDropzone = new Dropzone('#my-upload');
        myDropzone.on('success',function (file) {
            console.log(file.xhr.response);
            $('#test-img').attr('src',file.xhr.response);
        })
        $('.btn').click(function(){
            $.ajax({
                url:'/list/add',
                type:'post',
                data:{
                    title:$('input').eq(0).val(),
                    author:$('input').eq(1).val(),
                    intro:$('input').eq(2).val(),
                    time:$('input').eq(3).val(),
                    words:$('textarea').eq(0).val(),
                    imgSrc:$('#test-img').attr('src')
                },
                success:function (result) {
                    alert(result);
                }
            })
        })

    }
</script>
{% endblock %}