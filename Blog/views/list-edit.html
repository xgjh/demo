{% extends 'layout.html' %}
{% block content %}
<section class="content">
    <div class="box box-warning">
        <div class="box-header with-border">
            <h3 class="box-title">文章编辑</h3>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
            <!--<form role="form">-->
                <!-- text input -->
                <div class="form-group">
                    <label>标题</label>
                    <input type="text" class="form-control" value="{{title}}" >
                </div>
                <div class="form-group">
                    <label>作者</label>
                    <input type="text" class="form-control" value="{{author}}" >
                </div>
                <div class="form-group">
                    <label>简介</label>
                    <input type="text" class="form-control" value="{{intro}}" >
                </div>
                <div class="form-group">
                    <label>时间</label>
                    <div class="input-group date" data-provide="datepicker">
                        <input type="text" class="form-control" value="{{time}}">
                        <div class="input-group-addon">
                            <span class="glyphicon glyphicon-th"></span>
                        </div>
                    </div>
                </div>
                <input type="hidden" class="form-control" value="{{_id.toString()}}">
                <div class="form-group">
                    <label>上传图片</label>
                    <form action="/upload" method="post" class="dropzone" id="my-upload" style="border: 2px dashed #00acd6;">
                        <div class="fallback">
                            <input name="file" type="file" multiple />
                        </div>
                    </form>
                </div>
                <img src="{{imgSrc}}" id="test-img" alt="">

                <!-- textarea -->
                <div class="form-group">
                    <label>文章正文</label>
                    <textarea class="form-control" rows="3">{{words}}</textarea>
                </div>
                <div class="btn btn-primary">
                    确认修改</div>
            <!--</form>-->
        </div>
        <!-- /.box-body -->
    </div>

</section>
<script>
    window.onload=function(){
        $('.btn').click(function(){
            $.ajax({
                url:'/list/update',
                type:'post',
                data:{
                    title:$('input').eq(0).val(),
                    author:$('input').eq(1).val(),
                    intro:$('input').eq(2).val(),
                    time:$('input').eq(3).val(),
                    id:$('input').eq(4).val(),
                    words:$('textarea').eq(0).val(),
                    imgSrc:$('#test-img').attr('src')
                },
                success:function (result) {
                    alert(result);
                },
                error:function(err){
                    alert(err);
                }
            })
        })
    }
</script>
{% endblock %}